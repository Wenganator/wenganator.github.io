<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bible Reading Tracker Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 900px;
            width: 100%;
            padding: 40px;
        }
        h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-align: center;
        }
        .subtitle {
            color: #666;
            text-align: center;
            font-size: 1.1em;
            margin-bottom: 30px;
        }
        .features {
            background: #f8f9ff;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
        }
        .features h2 {
            color: #667eea;
            font-size: 1.5em;
            margin-bottom: 15px;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }
        .feature-item h3 {
            color: #333;
            font-size: 1.1em;
            margin-bottom: 8px;
        }
        .feature-item ul {
            list-style: none;
            padding-left: 0;
        }
        .feature-item li {
            color: #555;
            font-size: 0.9em;
            padding: 4px 0;
            padding-left: 20px;
            position: relative;
        }
        .feature-item li:before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: #667eea;
            font-weight: bold;
        }
        .quick-start {
            background: #fff4e6;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
        }
        .quick-start h2 {
            color: #e67e22;
            font-size: 1.5em;
            margin-bottom: 15px;
        }
        .quick-start ol {
            padding-left: 25px;
        }
        .quick-start li {
            color: #555;
            margin: 10px 0;
            line-height: 1.6;
        }
        .download-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: 1.2em;
            font-weight: bold;
            border-radius: 12px;
            cursor: pointer;
            width: 100%;
            transition: transform 0.2s, box-shadow 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        .download-btn:active {
            transform: translateY(0);
        }
        .download-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        .status {
            text-align: center;
            margin-top: 15px;
            color: #666;
            font-size: 0.95em;
        }
        .stats {
            text-align: center;
            margin-top: 20px;
            color: #888;
            font-size: 0.9em;
        }
        kbd {
            background: #f4f4f4;
            border: 1px solid #ccc;
            border-radius: 3px;
            padding: 2px 6px;
            font-family: monospace;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“– Bible Reading Tracker</h1>
        <p class="subtitle">Comprehensive Excel Spreadsheet Generator</p>
        
        <div class="features">
            <h2>âœ¨ Features Included</h2>
            <div class="feature-grid">
                <div class="feature-item">
                    <h3>ğŸ“– Old Testament</h3>
                    <ul>
                        <li>39 books with accurate chapter counts</li>
                        <li>Date tracking per chapter</li>
                        <li>Gray shading on non-existent chapters</li>
                        <li>Auto-completion tracking</li>
                        <li>Bookmark & notes system</li>
                    </ul>
                </div>
                <div class="feature-item">
                    <h3>ğŸ“– New Testament</h3>
                    <ul>
                        <li>27 books with chapter counts</li>
                        <li>Same tracking system as OT</li>
                        <li>Automatic completion detection</li>
                        <li>Bookmark functionality</li>
                        <li>Personal notes column</li>
                    </ul>
                </div>
                <div class="feature-item">
                    <h3>ğŸ“Š Summary Dashboard</h3>
                    <ul>
                        <li>Custom start date & duration</li>
                        <li>Auto-calculated progress percentages</li>
                        <li>Reading pace analysis</li>
                        <li>Auto-populated bookmarks list</li>
                        <li>"On track" status indicator</li>
                    </ul>
                </div>
                <div class="feature-item">
                    <h3>ğŸ“‹ Instructions</h3>
                    <ul>
                        <li>Complete setup guide</li>
                        <li>Formula activation steps</li>
                        <li>Date entry shortcuts</li>
                        <li>Formatting tips</li>
                        <li>Best practices</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="quick-start">
            <h2>âš¡ Quick Start Guide</h2>
            <ol>
                <li><strong>Click the button below</strong> to generate and download your tracker</li>
                <li><strong>Open the Excel file</strong> in Microsoft Excel, Google Sheets, or LibreOffice</li>
                <li><strong>Go to the Summary sheet</strong> and activate formulas by clicking each cell in column B and pressing Enter</li>
                <li><strong>Enter your start date and plan duration</strong> in cells B4 and B5</li>
                <li><strong>Start tracking!</strong> Use <kbd>Ctrl+;</kbd> (Windows) or <kbd>Cmd+;</kbd> (Mac) for quick date entry</li>
            </ol>
        </div>

        <button class="download-btn" onclick="generateExcel()" id="downloadBtn">
            <span>â¬‡</span>
            <span>Download Bible Reading Tracker</span>
        </button>
        
        <div class="status" id="status">Excel file will download automatically</div>
        
        <div class="stats">
            Total Chapters: Old Testament (929) â€¢ New Testament (260) â€¢ Complete Bible (1,189)
        </div>
    </div>

    <script>
        const oldTestament = [
            { name: 'Genesis', chapters: 50 }, { name: 'Exodus', chapters: 40 },
            { name: 'Leviticus', chapters: 27 }, { name: 'Numbers', chapters: 36 },
            { name: 'Deuteronomy', chapters: 34 }, { name: 'Joshua', chapters: 24 },
            { name: 'Judges', chapters: 21 }, { name: 'Ruth', chapters: 4 },
            { name: '1 Samuel', chapters: 31 }, { name: '2 Samuel', chapters: 24 },
            { name: '1 Kings', chapters: 22 }, { name: '2 Kings', chapters: 25 },
            { name: '1 Chronicles', chapters: 29 }, { name: '2 Chronicles', chapters: 36 },
            { name: 'Ezra', chapters: 10 }, { name: 'Nehemiah', chapters: 13 },
            { name: 'Esther', chapters: 10 }, { name: 'Job', chapters: 42 },
            { name: 'Psalms', chapters: 150 }, { name: 'Proverbs', chapters: 31 },
            { name: 'Ecclesiastes', chapters: 12 }, { name: 'Song of Solomon', chapters: 8 },
            { name: 'Isaiah', chapters: 66 }, { name: 'Jeremiah', chapters: 52 },
            { name: 'Lamentations', chapters: 5 }, { name: 'Ezekiel', chapters: 48 },
            { name: 'Daniel', chapters: 12 }, { name: 'Hosea', chapters: 14 },
            { name: 'Joel', chapters: 3 }, { name: 'Amos', chapters: 9 },
            { name: 'Obadiah', chapters: 1 }, { name: 'Jonah', chapters: 4 },
            { name: 'Micah', chapters: 7 }, { name: 'Nahum', chapters: 3 },
            { name: 'Habakkuk', chapters: 3 }, { name: 'Zephaniah', chapters: 3 },
            { name: 'Haggai', chapters: 2 }, { name: 'Zechariah', chapters: 14 },
            { name: 'Malachi', chapters: 4 }
        ];

        const newTestament = [
            { name: 'Matthew', chapters: 28 }, { name: 'Mark', chapters: 16 },
            { name: 'Luke', chapters: 24 }, { name: 'John', chapters: 21 },
            { name: 'Acts', chapters: 28 }, { name: 'Romans', chapters: 16 },
            { name: '1 Corinthians', chapters: 16 }, { name: '2 Corinthians', chapters: 13 },
            { name: 'Galatians', chapters: 6 }, { name: 'Ephesians', chapters: 6 },
            { name: 'Philippians', chapters: 4 }, { name: 'Colossians', chapters: 4 },
            { name: '1 Thessalonians', chapters: 5 }, { name: '2 Thessalonians', chapters: 3 },
            { name: '1 Timothy', chapters: 6 }, { name: '2 Timothy', chapters: 4 },
            { name: 'Titus', chapters: 3 }, { name: 'Philemon', chapters: 1 },
            { name: 'Hebrews', chapters: 13 }, { name: 'James', chapters: 5 },
            { name: '1 Peter', chapters: 5 }, { name: '2 Peter', chapters: 3 },
            { name: '1 John', chapters: 5 }, { name: '2 John', chapters: 1 },
            { name: '3 John', chapters: 1 }, { name: 'Jude', chapters: 1 },
            { name: 'Revelation', chapters: 22 }
        ];

        function generateExcel() {
            const btn = document.getElementById('downloadBtn');
            const status = document.getElementById('status');
            
            btn.disabled = true;
            btn.innerHTML = '<span>â³</span><span>Generating...</span>';
            status.textContent = 'Creating your Bible tracker...';
            
            setTimeout(() => {
                try {
                    const wb = XLSX.utils.book_new();
                    const maxChapters = 150;

                    // OLD TESTAMENT SHEET
                    const otData = [['Book', 'Total Chapters', 'Completed', 'Bookmark', 'Notes']];
                    for (let i = 1; i <= maxChapters; i++) {
                        otData[0].push(i);
                    }
                    
                    oldTestament.forEach((book, idx) => {
                        const rowNum = idx + 2;
                        const completedFormula = `=IF(COUNTBLANK(F${rowNum}:${XLSX.utils.encode_col(book.chapters + 5)}${rowNum})=0,"YES","")`;
                        const row = [book.name, book.chapters, completedFormula, '', ''];
                        for (let i = 1; i <= maxChapters; i++) {
                            row.push('');
                        }
                        otData.push(row);
                    });
                    
                    const otSheet = XLSX.utils.aoa_to_sheet(otData);
                    otSheet['!cols'] = [
                        { wch: 20 }, { wch: 15 }, { wch: 12 }, { wch: 10 }, { wch: 30 },
                        ...Array(maxChapters).fill({ wch: 12 })
                    ];
                    
                    XLSX.utils.book_append_sheet(wb, otSheet, 'Old Testament');

                    // NEW TESTAMENT SHEET
                    const ntData = [['Book', 'Total Chapters', 'Completed', 'Bookmark', 'Notes']];
                    for (let i = 1; i <= maxChapters; i++) {
                        ntData[0].push(i);
                    }
                    
                    newTestament.forEach((book, idx) => {
                        const rowNum = idx + 2;
                        const completedFormula = `=IF(COUNTBLANK(F${rowNum}:${XLSX.utils.encode_col(book.chapters + 5)}${rowNum})=0,"YES","")`;
                        const row = [book.name, book.chapters, completedFormula, '', ''];
                        for (let i = 1; i <= maxChapters; i++) {
                            row.push('');
                        }
                        ntData.push(row);
                    });
                    
                    const ntSheet = XLSX.utils.aoa_to_sheet(ntData);
                    ntSheet['!cols'] = [
                        { wch: 20 }, { wch: 15 }, { wch: 12 }, { wch: 10 }, { wch: 30 },
                        ...Array(maxChapters).fill({ wch: 12 })
                    ];
                    
                    XLSX.utils.book_append_sheet(wb, ntSheet, 'New Testament');

                    // SUMMARY SHEET
                    const summaryData = [
                        ['BIBLE READING TRACKER - SUMMARY DASHBOARD'], [],
                        ['READING PLAN CONFIGURATION'],
                        ['Start Date:', '1/1/2025', 'â† Enter your reading plan start date'],
                        ['Plan Duration (days):', 365, 'â† Enter total days (e.g., 365 for 1 year)'],
                        ['Today\'s Date:', '=TODAY()', 'â† Auto-calculated'],
                        ['Days Elapsed:', '=INT(B6-B4)', 'â† Auto-calculated'],
                        ['Days Remaining:', '=INT(B5-B7)', 'â† Auto-calculated'], [],
                        ['OLD TESTAMENT PROGRESS'],
                        ['Total OT Chapters:', 929],
                        ['Chapters Read:', '=SUMPRODUCT((\'Old Testament\'!F2:DX40<>"")*(\'Old Testament\'!F2:DX40<>0))', 'â† Auto-calculated'],
                        ['Chapters Remaining:', '=B11-B12', 'â† Auto-calculated'],
                        ['Percentage Complete:', '=IF(B11>0,B12/B11,0)', 'â† Auto-calculated'],
                        ['Books Completed:', '=COUNTIF(\'Old Testament\'!C2:C40,"YES")', 'â† Auto-calculated'], [],
                        ['NEW TESTAMENT PROGRESS'],
                        ['Total NT Chapters:', 260],
                        ['Chapters Read:', '=SUMPRODUCT((\'New Testament\'!F2:DX28<>"")*(\'New Testament\'!F2:DX28<>0))', 'â† Auto-calculated'],
                        ['Chapters Remaining:', '=B18-B19', 'â† Auto-calculated'],
                        ['Percentage Complete:', '=IF(B18>0,B19/B18,0)', 'â† Auto-calculated'],
                        ['Books Completed:', '=COUNTIF(\'New Testament\'!C2:C28,"YES")', 'â† Auto-calculated'], [],
                        ['OVERALL BIBLE PROGRESS'],
                        ['Total Bible Chapters:', 1189],
                        ['Chapters Read:', '=B12+B19', 'â† Sum of OT + NT'],
                        ['Chapters Remaining:', '=B25-B26', 'â† Auto-calculated'],
                        ['Percentage Complete:', '=IF(B25>0,B26/B25,0)', 'â† Auto-calculated'], [],
                        ['READING PACE ANALYSIS'],
                        ['Average Chapters/Day (Actual):', '=IF(B7>0,B26/B7,0)', 'â† Your actual pace'],
                        ['Required Chapters/Day (Target):', '=IF(B5>0,B25/B5,0)', 'â† Target to finish on time'],
                        ['Required Chapters/Day (Remaining):', '=IF(B8>0,B27/B8,0)', 'â† Pace needed now'],
                        ['On Track Status:', '=IF(B31>=B32,"Ahead of Pace","Behind Pace")', 'â† Ahead or Behind'], [],
                        ['BOOKMARKED CHAPTERS - OLD TESTAMENT'],
                        ['(Automatically populated below)'], []
                    ];
                    
                    // Add OT bookmark formulas
                    let otBookmarkRow = summaryData.length + 1;
                    oldTestament.forEach((book, idx) => {
                        const sheetRow = idx + 2;
                        summaryData.push([`=IF('Old Testament'!D${sheetRow}<>"", 'Old Testament'!A${sheetRow} & " (see notes)", "")`, '', '']);
                    });
                    
                    summaryData.push([]);
                    summaryData.push(['BOOKMARKED CHAPTERS - NEW TESTAMENT']);
                    summaryData.push(['(Automatically populated below)']);
                    summaryData.push([]);
                    
                    // Add NT bookmark formulas
                    newTestament.forEach((book, idx) => {
                        const sheetRow = idx + 2;
                        summaryData.push([`=IF('New Testament'!D${sheetRow}<>"", 'New Testament'!A${sheetRow} & " (see notes)", "")`, '', '']);
                    });
                    
                    const summarySheet = XLSX.utils.aoa_to_sheet(summaryData);
                    summarySheet['!cols'] = [{ wch: 35 }, { wch: 25 }, { wch: 50 }];
                    
                    XLSX.utils.book_append_sheet(wb, summarySheet, 'Summary');

                    // INSTRUCTIONS SHEET
                    const instructionsData = [
                        ['BIBLE READING TRACKER - COMPLETE INSTRUCTIONS'], [],
                        ['â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'], [],
                        ['IMPORTANT: FIRST-TIME SETUP - ACTIVATE FORMULAS'], [],
                        ['Before using the tracker, you MUST activate all formulas in the Summary sheet:'], [],
                        ['1. Open the Summary sheet'],
                        ['2. Click on cell B6 (Today\'s Date)'],
                        ['3. Press Enter'],
                        ['4. Click on cell B7 (Days Elapsed)'],
                        ['5. Press Enter'],
                        ['6. Repeat this process for ALL cells in column B from B6 through B34'],
                        ['7. This activates the formulas so they calculate automatically'], [],
                        ['NOTE: You only need to do this once when you first open the file.'],
                        ['After activation, the formulas will update automatically as you track your reading.'], [],
                        ['â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'], [],
                        ['GETTING STARTED'], [],
                        ['1. Go to the SUMMARY sheet (after activating formulas as described above)'],
                        ['   â€¢ Cell B4: Enter your reading plan start date (e.g., 1/1/2025)'],
                        ['   â€¢ Cell B5: Enter your plan duration in days (365 for 1 year, 730 for 2 years)'],
                        ['   â€¢ All other cells will calculate automatically'], [],
                        ['2. Begin tracking your daily reading'],
                        ['   â€¢ Go to the Old Testament or New Testament sheet'],
                        ['   â€¢ Find the book you\'re reading'],
                        ['   â€¢ Enter the date in the cell for the chapter you read'], [],
                        ['â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'], [],
                        ['HOW TO USE THE TRACKING SHEETS'], [],
                        ['Sheet Structure:'],
                        ['â€¢ Column A: Book name'],
                        ['â€¢ Column B: Total number of chapters in that book'],
                        ['â€¢ Column C: Completion status (automatically shows "YES" when all chapters are filled)'],
                        ['â€¢ Column D: Bookmark (enter "YES" or "â˜…" to mark important chapters)'],
                        ['â€¢ Column E: Notes (add personal reflections, insights, or reminders)'],
                        ['â€¢ Columns F onward: Individual chapter tracking (1, 2, 3, etc.)'], [],
                        ['Chapter Column Features:'],
                        ['â€¢ White cells: Chapters that exist for that book (available to fill in)'],
                        ['â€¢ The spreadsheet automatically marks books as complete when all chapters have dates'], [],
                        ['To Track a Chapter:'],
                        ['â€¢ Find the row for the book you\'re reading'],
                        ['â€¢ Find the column for the chapter number'],
                        ['â€¢ Enter the date you read it (see shortcuts below)'],
                        ['â€¢ Only fill in chapters that exist for each book (see Total Chapters column)'], [],
                        ['â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'], [],
                        ['KEYBOARD SHORTCUTS FOR DATE ENTRY'], [],
                        ['Quick Date Entry (TODAY):'],
                        ['â€¢ Windows: Press Ctrl + ; (semicolon)'],
                        ['â€¢ Mac: Press Cmd + ; (semicolon)'],
                        ['â€¢ This instantly enters today\'s date in the selected cell'], [],
                        ['Specific Date Entry:'],
                        ['â€¢ Just type the date: 12/9/2024 or 12-9-2024'],
                        ['â€¢ Excel will format it automatically'], [],
                        ['Backfilling Previous Readings:'],
                        ['â€¢ Enter the actual date you read that chapter'],
                        ['â€¢ This keeps your reading history accurate for the pace calculations'], [],
                        ['â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'], [],
                        ['AUTOMATIC COMPLETION TRACKING'], [],
                        ['Book Completion:'],
                        ['â€¢ Column C (Completed) automatically shows "YES" when all chapters have dates'],
                        ['â€¢ No manual entry needed - just fill in your chapter dates'],
                        ['â€¢ This count appears in your Summary dashboard statistics'], [],
                        ['â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'], [],
                        ['BOOKMARKS AND NOTES'], [],
                        ['Using Bookmarks (Column D):'],
                        ['â€¢ Enter "YES" or "â˜…" to mark chapters that impacted you'],
                        ['â€¢ Use bookmarks for chapters you want to return to'],
                        ['â€¢ Bookmarked books automatically appear in the Summary sheet'], [],
                        ['Consider bookmarking:'],
                        ['  â€¢ Life-changing passages'],
                        ['  â€¢ Difficult sections to revisit'],
                        ['  â€¢ Chapters for future study'],
                        ['  â€¢ Verses you\'re memorizing'], [],
                        ['Adding Notes (Column E):'],
                        ['â€¢ Record personal insights, questions, or applications'],
                        ['â€¢ Note cross-references to other chapters'],
                        ['â€¢ Track sermon or study connections'],
                        ['â€¢ Record prayer points from the passage'], [],
                        ['â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'], [],
                        ['UNDERSTANDING THE SUMMARY DASHBOARD'], [],
                        ['The Summary sheet automatically calculates everything after formula activation:'], [],
                        ['Reading Plan Configuration:'],
                        ['â€¢ Start Date: Your chosen beginning date (enter manually)'],
                        ['â€¢ Plan Duration: Total days to complete the Bible (enter manually)'],
                        ['â€¢ Today\'s Date: Automatically calculated each day'],
                        ['â€¢ Days Elapsed: Days since you started (auto-calculated)'],
                        ['â€¢ Days Remaining: Days left in your plan (auto-calculated)'], [],
                        ['Progress Statistics:'],
                        ['â€¢ Total Chapters: Fixed counts (OT=929, NT=260, Bible=1189)'],
                        ['â€¢ Chapters Read: Automatically counts cells with dates in OT/NT sheets'],
                        ['â€¢ Chapters Remaining: Total minus chapters read (auto-calculated)'],
                        ['â€¢ Percentage Complete: Visual progress indicator (auto-calculated, formatted as %)'],
                        ['â€¢ Books Completed: Counts books marked "YES" in Column C (auto-calculated)'], [],
                        ['Reading Pace Analysis:'],
                        ['â€¢ Average Chapters/Day (Actual): Your real reading pace since starting'],
                        ['â€¢ Required Chapters/Day (Target): Pace needed based on original plan'],
                        ['â€¢ Required Chapters/Day (Remaining): Current pace needed to finish on time'],
                        ['â€¢ On Track Status: Shows if you\'re "Ahead of Pace" or "Behind Pace"'], [],
                        ['Bookmarked Chapters:'],
                        ['â€¢ Automatically lists all books where you\'ve entered bookmarks'],
                        ['â€¢ Separated into Old Testament and New Testament sections'],
                        ['â€¢ Updates automatically as you add bookmarks'], [],
                        ['FORMAT PERCENTAGES:'],
                        ['â€¢ Cells B14, B21, and B28 show decimal values (e.g., 0.25)'],
                        ['â€¢ To display as percentages (e.g., 25%):'],
                        ['  1. Select cells B14, B21, and B28'],
                        ['  2. Right-click â†’ Format Cells'],
                        ['  3. Category: Percentage'],
                        ['  4. Decimal places: 1 or 2'],
                        ['  5. Click OK'], [],
                        ['â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'], [],
                        ['FORMULAS REFERENCE'], [],
                        ['All formulas are already included! Here they are for reference:'], [],
                        ['Summary Sheet Formulas:'],
                        ['Cell B6: =TODAY()'],
                        ['Cell B7: =INT(B6-B4)'],
                        ['Cell B8: =INT(B5-B7)'], [],
                        ['Cell B12: =SUMPRODUCT((\'Old Testament\'!F2:DX40<>"")*(\'Old Testament\'!F2:DX40<>0))'],
                        ['Cell B13: =B11-B12'],
                        ['Cell B14: =IF(B11>0,B12/B11,0)'],
                        ['Cell B15: =COUNTIF(\'Old Testament\'!C2:C40,"YES")'], [],
                        ['Cell B19: =SUMPRODUCT((\'New Testament\'!F2:DX28<>"")*(\'New Testament\'!F2:DX28<>0))'],
                        ['Cell B20: =B18-B19'],
                        ['Cell B21: =IF(B18>0,B19/B18,0)'],
                        ['Cell B22: =COUNTIF(\'New Testament\'!C2:C28,"YES")'], [],
                        ['Cell B26: =B12+B19'],
                        ['Cell B27: =B25-B26'],
                        ['Cell B28: =IF(B25>0,B26/B25,0)'], [],
                        ['Cell B31: =IF(B7>0,B26/B7,0)'],
                        ['Cell B32: =IF(B5>0,B25/B5,0)'],
                        ['Cell B33: =IF(B8>0,B27/B8,0)'],
                        ['Cell B34: =IF(B31>=B32,"Ahead of Pace","Behind Pace")'], [],
                        ['Old Testament/New Testament Completed Column Formulas:'],
                        ['Each book\'s Completed cell (Column C) contains a formula like:'],
                        ['=IF(COUNTBLANK(F2:XX2)=0,"YES","")'],
                        ['Where XX is the last chapter column for that book'], [],
                        ['Bookmark List Formulas:'],
                        ['Each bookmark row shows the book name if Column D has an entry:'],
                        ['=IF(\'Old Testament\'!D2<>"", \'Old Testament\'!A2 & " (see notes)", "")'], [],
                        ['â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'], [],
                        ['TIPS FOR SUCCESS'], [],
                        ['Daily Habits:'],
                        ['â€¢ Set a consistent reading time each day'],
                        ['â€¢ Use Ctrl+; (or Cmd+;) immediately after reading for quick tracking'],
                        ['â€¢ Review the Summary sheet weekly to monitor progress'],
                        ['â€¢ Add notes while insights are fresh'], [],
                        ['Staying on Track:'],
                        ['â€¢ Check "On Track Status" regularly in the Summary sheet'],
                        ['â€¢ If behind, adjust by reading extra chapters'],
                        ['â€¢ Don\'t stress about perfect consistency - life happens!'],
                        ['â€¢ Quality engagement matters more than speed'], [],
                        ['Making it Meaningful:'],
                        ['â€¢ Use the Notes column for personal application'],
                        ['â€¢ Bookmark chapters that speak to your current season'],
                        ['â€¢ Consider journaling alongside your reading'],
                        ['â€¢ Share insights with friends or small group'], [],
                        ['â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'], [],
                        ['TROUBLESHOOTING'], [],
                        ['If formulas show as text instead of calculating:'],
                        ['â€¢ You forgot to activate them! Go back to the first section of these instructions'],
                        ['â€¢ Click each formula cell in column B and press Enter'],
                        ['â€¢ Ensure Excel\'s calculation is set to Automatic (Formulas â†’ Calculation Options)'], [],
                        ['If dates look wrong or show as ####:'],
                        ['â€¢ The column may be too narrow - double-click the column border to auto-resize'],
                        ['â€¢ Right-click column header â†’ Column Width â†’ enter 12'],
                        ['â€¢ Right-click â†’ Format Cells â†’ Date â†’ choose your preferred date format'], [],
                        ['If chapter counts seem wrong:'],
                        ['â€¢ Make sure you\'re only entering dates in chapters that exist'],
                        ['â€¢ Check that dates are formatted as dates, not text'],
                        ['â€¢ Verify cell references in formulas match your data'], [],
                        ['If "Completed" column doesn\'t update:'],
                        ['â€¢ Ensure you\'ve filled in ALL chapters for that book with dates'],
                        ['â€¢ Check that the formula is present in the Completed cell'],
                        ['â€¢ Make sure dates are in the correct chapter columns'], [],
                        ['If bookmarks don\'t appear in Summary:'],
                        ['â€¢ Verify you entered something in Column D (Bookmark) for those books'],
                        ['â€¢ Check that the bookmark formulas are activated in the Summary sheet'],
                        ['â€¢ Try entering "YES" or "â˜…" exactly in the Bookmark column'], [],
                        ['â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'], [],
                        ['BIBLE CHAPTER COUNTS REFERENCE'], [],
                        ['Old Testament (929 total chapters):'],
                        ['Genesis (50), Exodus (40), Leviticus (27), Numbers (36), Deuteronomy (34),'],
                        ['Joshua (24), Judges (21), Ruth (4), 1 Samuel (31), 2 Samuel (24),'],
                        ['1 Kings (22), 2 Kings (25), 1 Chronicles (29), 2 Chronicles (36), Ezra (10),'],
                        ['Nehemiah (13), Esther (10), Job (42), Psalms (150), Proverbs (31),'],
                        ['Ecclesiastes (12), Song of Solomon (8), Isaiah (66), Jeremiah (52),'],
                        ['Lamentations (5), Ezekiel (48), Daniel (12), Hosea (14), Joel (3), Amos (9),'],
                        ['Obadiah (1), Jonah (4), Micah (7), Nahum (3), Habakkuk (3), Zephaniah (3),'],
                        ['Haggai (2), Zechariah (14), Malachi (4)'], [],
                        ['New Testament (260 total chapters):'],
                        ['Matthew (28), Mark (16), Luke (24), John (21), Acts (28), Romans (16),'],
                        ['1 Corinthians (16), 2 Corinthians (13), Galatians (6), Ephesians (6),'],
                        ['Philippians (4), Colossians (4), 1 Thessalonians (5), 2 Thessalonians (3),'],
                        ['1 Timothy (6), 2 Timothy (4), Titus (3), Philemon (1), Hebrews (13),'],
                        ['James (5), 1 Peter (5), 2 Peter (3), 1 John (5), 2 John (1), 3 John (1),'],
                        ['Jude (1), Revelation (22)'], [],
                        ['â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'], [],
                        ['May your time in God\'s Word be blessed and transformative!'], [],
                        ['For technical questions about Excel, consult Excel help documentation.'],
                        ['For questions about the Bible, consult your pastor or trusted spiritual mentor.']
                    ];
                    
                    const instructionsSheet = XLSX.utils.aoa_to_sheet(instructionsData);
                    instructionsSheet['!cols'] = [{ wch: 100 }];
                    XLSX.utils.book_append_sheet(wb, instructionsSheet, 'Instructions');

                    // Download
                    XLSX.writeFile(wb, 'Bible_Reading_Tracker.xlsx');
                    
                    status.textContent = 'âœ“ Download complete! Check your downloads folder.';
                    btn.innerHTML = '<span>âœ“</span><span>Downloaded Successfully!</span>';
                    
                    setTimeout(() => {
                        btn.disabled = false;
                        btn.innerHTML = '<span>â¬‡</span><span>Download Bible Reading Tracker</span>';
                        status.textContent = 'Click to download again if needed';
                    }, 3000);
                    
                } catch (error) {
                    console.error('Error:', error);
                    status.textContent = 'âŒ Error generating file. Please refresh and try again.';
                    btn.disabled = false;
                    btn.innerHTML = '<span>â¬‡</span><span>Try Again</span>';
                }
            }, 100);
        }
    </script>
</body>
</html>
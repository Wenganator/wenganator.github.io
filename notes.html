<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>
        Notes
    </title>

    <!-- Favicon links (generated by favicon.io) -->
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
    <link rel="manifest" href="/assets/favicon/site.webmanifest">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <!-- My personal CSS -->
    <link rel="stylesheet" href="/styles/fonts.css">
    <link rel="stylesheet" href="/styles/style.css">
    <style>
        #editor {
            border: 1px solid #ced4da;
            padding: 10px;
            min-height: 300px;
            overflow-y: auto;
            background-color: #ffffff;
        }
    </style>
</head>
<body>
    <div id="header"></div> <!-- Modify header content in header.html -->

    <div class="container my-4">
        <h1 class="text-center">Note-Taking App</h1>

        <!-- Toolbar -->
        <div class="btn-toolbar mb-3" role="toolbar">
            <div class="btn-group me-2" role="group">
                <select id="fontType" class="form-select">
                    <option value="Arial">Arial</option>
                    <option value="Times New Roman">Times New Roman</option>
                    <option value="Courier New">Courier New</option>
                    <option value="Verdana">Verdana</option>
                    <option value="Garamond">Garamond</option>
                    <option value="Comic Sans MS">Comic Sans MS</option>
                    <option value="Impact">Impact</option>
                </select>
            </div>
            <div class="btn-group me-2" role="group">
                <select id="fontSize" class="form-select">
                    <option value="1">Small</option>
                    <option value="3" selected>Normal</option>
                    <option value="5">Large</option>
                    <option value="7">Huge</option>
                </select>
            </div>
            <div class="btn-group me-2" role="group">
                <button class="btn btn-outline-secondary" onclick="execCmd('bold')">B</button>
                <button class="btn btn-outline-secondary" onclick="execCmd('italic')"><i>I</i></button>
                <button class="btn btn-outline-secondary" onclick="execCmd('underline')">U</button>
                <button class="btn btn-outline-secondary" onclick="execCmd('strikethrough')">S</button>
            </div>
            <div class="btn-group me-2" role="group">
                <button class="btn btn-outline-secondary" onclick="execCmd('justifyLeft')">Left</button>
                <button class="btn btn-outline-secondary" onclick="execCmd('justifyCenter')">Center</button>
                <button class="btn btn-outline-secondary" onclick="execCmd('justifyRight')">Right</button>
                <button class="btn btn-outline-secondary" onclick="execCmd('justifyFull')">Justify</button>
            </div>
            <div class="btn-group me-2" role="group">
                <button class="btn btn-outline-secondary" onclick="execCmd('insertUnorderedList')">&#8226; List</button>
                <button class="btn btn-outline-secondary" onclick="execCmd('insertOrderedList')">1. List</button>
            </div>
            <div class="btn-group me-2" role="group">
                <button class="btn btn-outline-secondary" onclick="execCmd('superscript')">X<sup>2</sup></button>
                <button class="btn btn-outline-secondary" onclick="execCmd('subscript')">X<sub>2</sub></button>
            </div>
            <div class="btn-group me-2" role="group">
                <input type="color" id="fontColor" class="form-control form-control-color" title="Text Color">
                <button class="btn btn-outline-secondary" onclick="changeFontColor()">A</button>
                <input type="color" id="highlightColor" class="form-control form-control-color" title="Highlight Color">
                <button class="btn btn-outline-secondary" onclick="changeHighlightColor()">Highlight</button>
            </div>
        </div>

        <!-- Editor -->
        <div id="editor" contenteditable="true"></div>

        <!-- Save/Load/Delete/Search/Export Buttons -->
        <div class="mt-3">
            <input type="text" id="noteName" class="form-control mb-2" placeholder="Enter note name">
            <button class="btn btn-primary" onclick="saveNote()">Save Note</button>
            <button class="btn btn-success" onclick="loadNotes()">Load Notes</button>
            <button class="btn btn-danger" onclick="deleteNote()">Delete Note</button>
            <button class="btn btn-info" onclick="searchNotes()">Search Notes</button>
            <button class="btn btn-secondary" onclick="exportNotes()">Export Notes</button>
            <button class="btn btn-secondary" onclick="importNotes()">Import Notes</button>
        </div>

        <!-- Notes List -->
        <div id="notesList" class="mt-3"></div>

        <!-- Tagging Section -->
        <div class="mt-3">
            <input type="text" id="noteTags" class="form-control mb-2" placeholder="Enter tags (comma-separated)">
        </div>

        <!-- Dark Mode Toggle -->
        <div class="form-check form-switch mt-3">
            <input class="form-check-input" type="checkbox" id="darkModeToggle" onclick="toggleDarkMode()">
            <label class="form-check-label" for="darkModeToggle">Dark Mode</label>
        </div>

        <br>
        <br>
        <br>
        <br>
        <br>
        
    </div>

    <div id="footer"></div> <!-- Modify footer content in footer.html -->

    <!-- Bootstrap JS (includes Popper.js and Bootstrap JS) -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>

    <!-- My personal JS -->
    <script src="/scripts/app.js" defer></script>

    <script>
        const editor = document.getElementById('editor');

        function execCmd(command) {
            document.execCommand(command, false, null);
        }

        function changeFontColor() {
            const color = document.getElementById('fontColor').value;
            document.execCommand('foreColor', false, color);
        }

        function changeHighlightColor() {
            const color = document.getElementById('highlightColor').value;
            document.execCommand('hiliteColor', false, color);
        }

        document.getElementById('fontType').addEventListener('change', function() {
            document.execCommand('fontName', false, this.value);
        });

        document.getElementById('fontSize').addEventListener('change', function() {
            document.execCommand('fontSize', false, this.value);
        });

        function saveNote() {
            const noteNameInput = document.getElementById('noteName').value.trim();
            if (!noteNameInput) {
                alert('Please enter a name for the note.');
                return;
            }

            const noteName = `note-${noteNameInput}`;
            const noteTags = document.getElementById('noteTags').value.trim(); // Allow empty tags for deletion
            const noteData = {
                content: editor.innerHTML,
                tags: noteTags,
                timestamp: new Date().toISOString(),
            };

            localStorage.setItem(noteName, JSON.stringify(noteData));
            alert('Note saved!');
            loadNotes(); // Refresh the list of notes
        }

        function loadNotes() {
            const notesList = document.getElementById('notesList');
            notesList.innerHTML = '';
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (!key.startsWith('note-')) continue;

                const button = document.createElement('button');
                button.textContent = key.replace('note-', '');
                button.className = 'btn btn-link';
                button.onclick = function () {
                    const noteData = JSON.parse(localStorage.getItem(key));
                    editor.innerHTML = noteData.content;
                    document.getElementById('noteTags').value = noteData.tags || ''; // Populate tags
                    document.getElementById('noteName').value = key.replace('note-', ''); // Update note name input field
                };
                notesList.appendChild(button);
            }
        }

        function deleteNote() {
            const noteNameInput = document.getElementById('noteName').value.trim();
            if (!noteNameInput) {
                alert('Please enter the name of the note to delete.');
                return;
            }

            const noteName = `note-${noteNameInput}`;
            if (localStorage.getItem(noteName)) {
                localStorage.removeItem(noteName);
                alert(`Note "${noteNameInput}" deleted!`);
                loadNotes(); // Refresh the notes list
                editor.innerHTML = ''; // Clear the editor
                document.getElementById('noteTags').value = ''; // Clear the tags
                document.getElementById('noteName').value = ''; // Clear the name field
            } else {
                alert(`Note "${noteNameInput}" not found.`);
            }
        }

        function searchNotes() {
            const searchTerm = document.getElementById('noteName').value.toLowerCase();
            const notesList = document.getElementById('notesList');
            notesList.innerHTML = '';
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (!key.startsWith('note-')) continue;
                if (key.toLowerCase().includes(searchTerm)) {
                    const button = document.createElement('button');
                    button.textContent = key.replace('note-', '');
                    button.className = 'btn btn-link';
                    button.onclick = function() {
                        const noteData = JSON.parse(localStorage.getItem(key));
                        editor.innerHTML = noteData.content;
                        document.getElementById('noteTags').value = noteData.tags;
                    };
                    notesList.appendChild(button);
                }
            }
        }

        function exportNotes() {
            const allNotes = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (!key.startsWith('note-')) continue;
                allNotes[key] = JSON.parse(localStorage.getItem(key));
            }
            const dataStr = JSON.stringify(allNotes, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'notes.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        function importNotes() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(event) {
                const file = event.target.files[0];
                const reader = new FileReader();
                reader.onload = function() {
                    try {
                        const importedNotes = JSON.parse(reader.result);
                        for (const [key, value] of Object.entries(importedNotes)) {
                            if (key.startsWith('note-')) {
                                localStorage.setItem(key, JSON.stringify(value));
                            }
                        }
                        alert('Notes imported successfully!');
                        loadNotes();
                    } catch (e) {
                        alert('Failed to import notes. Please check the file format.');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        function toggleDarkMode() {
            const isDarkMode = document.getElementById('darkModeToggle').checked;
            document.body.style.backgroundColor = isDarkMode ? '#121212' : '#ffffff';
            document.body.style.color = isDarkMode ? '#ffffff' : '#000000';
            editor.style.backgroundColor = isDarkMode ? '#2c2c2c' : '#ffffff';
            editor.style.color = isDarkMode ? '#ffffff' : '#000000';
        }

        // Load existing notes on page load
        document.addEventListener('DOMContentLoaded', () => {
            loadNotes();
        });
    </script>
</body>
</html>
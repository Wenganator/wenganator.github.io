<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>E-Book Reader</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <style>
    #pdfCanvas { border: 1px solid #ccc; }
    .reader-container { position: relative; }
    .nav-button { position: absolute; top: 50%; transform: translateY(-50%); cursor: pointer; }
    .nav-left { left: 10px; }
    .nav-right { right: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <!-- Book Selection -->
    <div class="form-group">
      <label for="bookSelect">Select a book:</label>
      <select id="bookSelect" class="form-control">
        <option value="/assets/pdf/Scripture-Memorization.pdf">Book 1</option>
        <option value="book2.pdf">Book 2</option>
        <!-- Add more options -->
      </select>
    </div>
    
    <!-- Navigation Options -->
    <div class="form-group">
      <label>Navigation Orientation:</label>
      <div>
        <input type="radio" name="navOrientation" id="vertical" value="vertical" checked>
        <label for="vertical">Vertical</label>
        <input type="radio" name="navOrientation" id="horizontal" value="horizontal">
        <label for="horizontal">Horizontal</label>
      </div>
    </div>
    
    <!-- Page Jump -->
    <div class="form-group">
      <label for="pageInput">Jump to page:</label>
      <input type="number" id="pageInput" class="form-control" min="1">
      <button id="jumpButton" class="btn btn-primary mt-2">Go</button>
    </div>
    
    <!-- PDF Viewer -->
    <div class="reader-container">
      <canvas id="pdfCanvas"></canvas>
      <!-- Navigation Arrows -->
      <div class="nav-button nav-left" id="prevPage">&larr;</div>
      <div class="nav-button nav-right" id="nextPage">&rarr;</div>
    </div>
    
    <!-- Bookmark Panel -->
    <div id="bookmarkPanel" class="mt-4">
      <h5>Bookmarks</h5>
      <ul id="bookmarkList" class="list-group"></ul>
    </div>
  </div>
  
  <!-- Include PDF.js Library -->
  <script src="https://mozilla.github.io/pdf.js/build/pdf.js"></script>
  <!-- Your custom JS file -->
  <script>
    // Configure PDF.js
pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://mozilla.github.io/pdf.js/build/pdf.worker.js';

let pdfDoc = null;
let currentPage = 1;
let totalPages = 0;
const canvas = document.getElementById('pdfCanvas');
const ctx = canvas.getContext('2d');
const scale = 1.5; // Adjust for your needs

// Load a PDF document
function loadPDF(url) {
  pdfjsLib.getDocument(url).promise.then(doc => {
    pdfDoc = doc;
    totalPages = doc.numPages;
    currentPage = 1;
    renderPage(currentPage);
  });
}

// Render a page
function renderPage(pageNumber) {
  pdfDoc.getPage(pageNumber).then(page => {
    const viewport = page.getViewport({ scale: scale });
    canvas.height = viewport.height;
    canvas.width = viewport.width;
    const renderContext = {
      canvasContext: ctx,
      viewport: viewport,
    };
    page.render(renderContext);
  });
}

// Event listeners for navigation
document.getElementById('prevPage').addEventListener('click', () => {
  if (currentPage > 1) {
    currentPage--;
    renderPage(currentPage);
  }
});
document.getElementById('nextPage').addEventListener('click', () => {
  if (currentPage < totalPages) {
    currentPage++;
    renderPage(currentPage);
  }
});

// Handle page jump
document.getElementById('jumpButton').addEventListener('click', () => {
  const pageInput = document.getElementById('pageInput').value;
  const pageNumber = parseInt(pageInput);
  if (pageNumber >= 1 && pageNumber <= totalPages) {
    currentPage = pageNumber;
    renderPage(currentPage);
  }
});

// Keyboard navigation
document.addEventListener('keydown', (e) => {
  // For both vertical and horizontal navigation, adapt based on selected orientation
  const navOrientation = document.querySelector('input[name="navOrientation"]:checked').value;
  if ((navOrientation === 'vertical' && (e.key === 'ArrowUp' || e.key === 'ArrowDown')) ||
      (navOrientation === 'horizontal' && (e.key === 'ArrowLeft' || e.key === 'ArrowRight'))) {
    if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
      if (currentPage > 1) { currentPage--; renderPage(currentPage); }
    } else {
      if (currentPage < totalPages) { currentPage++; renderPage(currentPage); }
    }
  }
});

// Example: Book selection
document.getElementById('bookSelect').addEventListener('change', (e) => {
  loadPDF(e.target.value);
});

// Initialize with first book
window.addEventListener('load', () => {
  loadPDF(document.getElementById('bookSelect').value);
});

// Bookmarking functions (saving and retrieving from local storage)
const storageKey = 'ebookBookmarks_YourUniqueAppName';

function saveBookmark(book, page) {
  const bookmarks = JSON.parse(localStorage.getItem(storageKey)) || {};
  bookmarks[book] = bookmarks[book] || [];
  if (!bookmarks[book].includes(page)) {
    bookmarks[book].push(page);
    localStorage.setItem(storageKey, JSON.stringify(bookmarks));
    updateBookmarkList(book);
  }
}

function updateBookmarkList(book) {
  const bookmarks = JSON.parse(localStorage.getItem(storageKey)) || {};
  const list = document.getElementById('bookmarkList');
  list.innerHTML = '';
  (bookmarks[book] || []).forEach(page => {
    const li = document.createElement('li');
    li.textContent = `Page ${page}`;
    li.className = 'list-group-item';
    li.addEventListener('click', () => {
      currentPage = page;
      renderPage(currentPage);
    });
    list.appendChild(li);
  });
}

// Example: Add bookmark button (you could place this on your UI)
const bookmarkBtn = document.createElement('button');
bookmarkBtn.textContent = 'Bookmark this page';
bookmarkBtn.className = 'btn btn-secondary mt-2';
bookmarkBtn.addEventListener('click', () => {
  const book = document.getElementById('bookSelect').value;
  saveBookmark(book, currentPage);
});
document.querySelector('.container').appendChild(bookmarkBtn);

  </script>
</body>
</html>

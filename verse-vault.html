<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <title>Verse Vault</title>

        <!-- Favicon links (generated by favicon.io) -->
        <link rel="apple-touch-icon" sizes="180x180" href="./assets/favicon/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="./assets/favicon/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="./assets/favicon/favicon-16x16.png">
        <link rel="manifest" href="./assets/favicon/site.webmanifest">

        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

        <!-- My personal CSS -->
        <link rel="stylesheet" href="styles/fonts.css">
        <link rel="stylesheet" href="styles/style.css">
        <style>
            body {
                background-color: #f8f9fa;
                font-family: Arial, sans-serif;
            }
            .verse-display {
                background-color: #fff;
                border-radius: 8px;
                padding: 20px;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            }
        </style>
    </head>
    <body>
        <div id="header"></div> <!-- Modify header content in header.html -->

        <div class="container py-5">
            <h1 class="text-center mb-4">Verse Vault</h1>

            <!-- Filters -->
            <div class="mb-4">
                <div class="row">
                    <div class="col-md-4">
                        <select id="testamentSelect" class="form-select">
                            <option value="">Select Testament</option>
                            <option value="Old">Old Testament</option>
                            <option value="New">New Testament</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <select id="bookSelect" class="form-select" disabled>
                            <option value="">Select Book</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <select id="chapterVerseSelect" class="form-select" disabled>
                            <option value="">Select Chapter/Verse</option>
                        </select>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-md-12">
                        <button id="randomButton" class="btn btn-primary d-grid col-4 mx-auto">Random Passage</button>
                    </div>
                </div>
            </div>

            <!-- Verse Display Section -->
            <div id="verseContainer" class="text-center mb-4 d-none">
                <h2 id="verseTitle"></h2>
                <p id="verseText" class="mt-3"></p>
                <div class="mt-3">
                    <label for="translationSelect" class="form-label">Translation:</label>
                    <select id="translationSelect" class="form-select d-inline w-auto">
                        <option value="ESV">ESV</option>
                        <option value="KJV">KJV</option>
                        <option value="NASB">NASB</option>
                        <option value="NIV">NIV</option>
                        <option value="NKJV">NKJV</option>
                    </select>
                </div>
                <button id="bookmarkButton" class="btn btn-success mt-3">Bookmark</button>
            </div>

            <!-- Bookmarked Verses Section -->
            <div id="bookmarksSection" class="mt-5">
                <h3>Bookmarked Passages</h3>
                <ul id="bookmarkedList" class="list-group">
                    <!-- Bookmarked items will appear here -->
                </ul>
                <button id="clearBookmarks" class="btn btn-danger mt-3">Clear Bookmarks</button>
            </div>
        </div>

        <script>
            const bibleData = { 
                "Old": {
                    "Genesis": [
                        { "reference": "Genesis 1:1", "ESV": "In the beginning, God created the heavens and the earth.", "KJV": "In the beginning God created the heaven and the earth." },
                        { "reference": "Genesis 1:2", "ESV": "The earth was without form and void, and darkness was over the face of the deep.", "KJV": "And the earth was without form, and void; and darkness was upon the face of the deep." }
                    ]
                },
                "New": {
                    "John": [
                        { "reference": "John 3:16", "ESV": "For God so loved the world...", "KJV": "For God so loved the world, that he gave his only begotten Son..." }
                    ]
                }
            };

            const bookmarks = JSON.parse(localStorage.getItem('bookmarks')) || [];
            const testamentSelect = document.getElementById('testamentSelect');
            const bookSelect = document.getElementById('bookSelect');
            const chapterVerseSelect = document.getElementById('chapterVerseSelect');
            const verseContainer = document.getElementById('verseContainer');
            const verseTitle = document.getElementById('verseTitle');
            const verseText = document.getElementById('verseText');
            const translationSelect = document.getElementById('translationSelect');
            const bookmarkButton = document.getElementById('bookmarkButton');
            const bookmarkedList = document.getElementById('bookmarkedList');
            const clearBookmarks = document.getElementById('clearBookmarks');
            const randomButton = document.getElementById('randomButton');

            function populateBooks(testament) {
                bookSelect.innerHTML = '<option value="">Select Book</option>';
                chapterVerseSelect.innerHTML = '<option value="">Select Chapter/Verse</option>';
                chapterVerseSelect.disabled = true;
                if (bibleData[testament]) {
                    Object.keys(bibleData[testament]).forEach(book => {
                        const option = document.createElement('option');
                        option.value = book;
                        option.textContent = book;
                        bookSelect.appendChild(option);
                    });
                    bookSelect.disabled = false;
                } else {
                    bookSelect.disabled = true;
                }
            }

            function populateChapterVerses(testament, book) {
                chapterVerseSelect.innerHTML = '<option value="">Select Chapter/Verse</option>';
                if (bibleData[testament] && bibleData[testament][book]) {
                    bibleData[testament][book].forEach((verse, index) => {
                        const option = document.createElement('option');
                        option.value = index;
                        option.textContent = verse.reference;
                        chapterVerseSelect.appendChild(option);
                    });
                    chapterVerseSelect.disabled = false;
                } else {
                    chapterVerseSelect.disabled = true;
                }
            }

            function updateBookmarks() {
                bookmarkedList.innerHTML = '';
                bookmarks.forEach(verse => {
                    const li = document.createElement('li');
                    li.className = 'list-group-item d-flex justify-content-between align-items-center';
                    li.textContent = verse.split('|')[2]; //Extracts and displays only the Reference part
                    li.onclick = () => {
                        const [testament, book, reference] = verse.split('|');
                        const selectedVerse = bibleData[testament][book].find(v => v.reference === reference);
                        verseTitle.textContent = selectedVerse.reference;
                        verseText.textContent = selectedVerse[translationSelect.value];
                        verseContainer.classList.remove('d-none');
                    };
                    const removeBtn = document.createElement('button');
                    removeBtn.className = 'btn btn-sm btn-danger';
                    removeBtn.textContent = 'Remove';
                    removeBtn.onclick = (e) => {
                        e.stopPropagation();
                        bookmarks.splice(bookmarks.indexOf(verse), 1);
                        localStorage.setItem('bookmarks', JSON.stringify(bookmarks));
                        updateBookmarks();
                    };
                    li.appendChild(removeBtn);
                    bookmarkedList.appendChild(li);
                });
            }

            testamentSelect.addEventListener('change', () => {
                populateBooks(testamentSelect.value);
            });

            bookSelect.addEventListener('change', () => {
                const testament = testamentSelect.value;
                const book = bookSelect.value;
                populateChapterVerses(testament, book);
            });

            chapterVerseSelect.addEventListener('change', () => {
                const testament = testamentSelect.value;
                const book = bookSelect.value;
                const verseIndex = chapterVerseSelect.value;
                if (testament && book && verseIndex !== "") {
                    const verse = bibleData[testament][book][verseIndex];
                    verseTitle.textContent = verse.reference;
                    verseText.textContent = verse[translationSelect.value];
                    verseContainer.classList.remove('d-none');
                }
            });

            translationSelect.addEventListener('change', () => {
                const testament = testamentSelect.value;
                const book = bookSelect.value;
                const verseIndex = chapterVerseSelect.value;
                if (testament && book && verseIndex !== "") {
                    const verse = bibleData[testament][book][verseIndex];
                    verseText.textContent = verse[translationSelect.value];
                }
            });

            randomButton.addEventListener('click', () => {
                const testaments = Object.keys(bibleData);
                const randomTestament = testaments[Math.floor(Math.random() * testaments.length)];
                const books = Object.keys(bibleData[randomTestament]);
                const randomBook = books[Math.floor(Math.random() * books.length)];
                const verses = bibleData[randomTestament][randomBook];
                const randomVerse = verses[Math.floor(Math.random() * verses.length)];

                // Update the verse display
                verseTitle.textContent = randomVerse.reference;
                verseText.textContent = randomVerse[translationSelect.value];
                verseContainer.classList.remove('d-none');

                // Update the dropdown states to reflect the random selection
                testamentSelect.value = randomTestament;
                populateBooks(randomTestament);
                bookSelect.value = randomBook;
                populateChapterVerses(randomTestament, randomBook);

                // Find and set the random verse index in the dropdown
                const randomVerseIndex = verses.findIndex(v => v.reference === randomVerse.reference);
                chapterVerseSelect.value = randomVerseIndex;
            });

            bookmarkButton.addEventListener('click', () => {
                const testament = testamentSelect.value;
                const book = bookSelect.value;
                const verseIndex = chapterVerseSelect.value;
                if (testament && book && verseIndex !== "") {
                    const verse = bibleData[testament][book][verseIndex];
                    const bookmarkIdentifier = `${testament}|${book}|${verse.reference}`;
                    if (!bookmarks.includes(bookmarkIdentifier)) {
                        bookmarks.push(bookmarkIdentifier);
                        localStorage.setItem('bookmarks', JSON.stringify(bookmarks));
                        updateBookmarks();
                    }
                }
            });

            clearBookmarks.addEventListener('click', () => {
                bookmarks.length = 0;
                localStorage.setItem('bookmarks', JSON.stringify(bookmarks));
                updateBookmarks();
            });

            updateBookmarks();
        </script>
        <div id="footer"></div> <!-- Modify footer content in footer.html -->

        <!-- Bootstrap JS (includes Popper.js and Bootstrap JS) -->
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>

        <!-- My personal JS -->
        <script src="scripts/app.js" defer></script>
        <!-- Add additional JS here as needed -->
    </body>
</html>
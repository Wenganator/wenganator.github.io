<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <title>
            Movies
        </title>

        <!-- Favicon links (generated by favicon.io) -->
        <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
        <link rel="manifest" href="/assets/favicon/site.webmanifest">

        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

        <!-- My personal CSS -->
        <link rel="stylesheet" href="/styles/fonts.css">
        <link rel="stylesheet" href="/styles/style.css">
        <link rel="stylesheet" href="/styles/blog.css">

        <!-- Could directly link to tier-list.css but need to manually edit some properties below -->
        <!-- <link rel="stylesheet" href="/styles/tier-list.css"> -->

        <!-- Bootstrap icons CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"/>

        <!-- Add additional stylesheets here to override original styles as needed -->
        <style>
            :root {
            --bg-color: #27272a;
            --tier-bg-color: #404040;
            --tier-control-bg-color: #262626;
            /* --border-color: #0a0a0a; */
            --card-size: 75px;
            }

            body {
            background: var(--bg-color);
            min-height: 100vh;
            /* display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start; */
            }

            /* h1 {
            color: #fff;
            text-align: center;
            margin: 1rem 0;
            user-select: none;
            } */

            img {
            width: var(--card-size);
            aspect-ratio: 1;
            object-fit: cover;
            cursor: grab;
            }

            img.dragging {
            opacity: 0.25;
            }

            button {
            cursor: pointer;
            border: none;
            transition: 0.5s;
            }

            /* .container {
            width: min(1200px, 80%);
            margin: 0 auto;
            border: 2px solid var(--border-color);
            } */

            /* .upload-container {
                color: #ffffff;
                font-size: 0.9rem;
            } */

            .tiers:empty::before {
            content: attr(data-placeholder);
            height: var(--card-size);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 0.875rem;
            background: var(--tier-bg-color);
            }

            .tier {
            background: var(--tier-bg-color);
            display: flex;
            gap: 2px;
            }

            .tier:not(:last-child) {
            border-bottom: 2px solid var(--border-color);
            }

            .label {
            flex-shrink: 0;
            width: 100px;
            min-height: var(--card-size);
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--color, lightcoral);
            font-size: 1.5rem;
            font-weight: 500;
            line-height: 1rem;
            text-align: center;
            overflow-wrap: break-word;
            }

            .label span {
            overflow: hidden;
            padding: 0.5rem;
            }

            .items {
            display: flex;
            align-items: flex-start;
            flex-wrap: wrap;
            flex: 1;
            }

            .controls {
            width: 50px;
            background: var(--tier-control-bg-color);
            display: grid;
            align-content: center;
            justify-items: center;
            }

            .controls button {
            font-size: 1rem;
            background: transparent;
            color: #fff;
            opacity: 0.75;
            }

            .controls button:is(:active, :hover) {
            opacity: 1;
            }

            @media (min-width: 768px) {
            .controls {
                grid-template-columns: repeat(2, 1fr);
                width: 64px;
            }

            .controls .settings {
                grid-row: span 2;
            }

            .controls button {
                font-size: 1.5rem;
            }
            }

            .cards {
            display: flex;
            align-items: flex-start;
            flex-wrap: wrap;
            margin-top: 2rem;
            min-height: calc(var(--card-size) * 2);
            background: var(--tier-bg-color);
            }

            @media (max-width: 480px) {
            .cards {
                align-items: center;
                flex-wrap: nowrap;
                position: fixed;
                bottom: 0;
                margin-top: 0;
                min-height: calc(var(--card-size) * 2);
                width: 100%;
                overflow-x: auto;
            }
            }

            .settings-modal[open] {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: none;
            border-radius: 0.25rem;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.25);
            }

            .settings-modal::backdrop {
            background: rgba(0, 0, 0, 0.5);
            cursor: pointer;
            }

            .settings-modal section {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            padding: 2rem;
            width: max-content;
            }

            .colors,
            .tier-label {
            grid-column: span 2;
            }

            .colors {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            }

            .colors input {
            appearance: none;
            }

            .colors label {
            width: 1rem;
            height: 1rem;
            background: var(--color);
            border-radius: 50%;
            cursor: pointer;
            transition: 0.3s;
            position: relative;
            }

            .colors label:has(input:checked)::before {
            content: "\F26A";
            font-family: "bootstrap-icons";
            background: #fff;
            color: var(--color);
            position: absolute;
            inset: 0;
            border-radius: inherit;
            }

            .colors label:has(input:checked) {
            box-shadow: 0 0 0 2px #fff, 0 0 0 3px var(--color), 0 0 8px rgba(0, 0, 0, 0.5);
            }

            .tier-label {
            border: 1px solid lightgray;
            border-radius: 0.25rem;
            outline-color: var(--border-color);
            padding: 0.5rem;
            resize: none;
            }

            .settings-modal button {
            text-wrap: nowrap;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            color: #000;
            font-size: 0.875rem;
            }

            .settings-modal button:is(:active, :hover) {
            background: lightgray;
            }
        </style>
    </head>
    <body style="background-color: #fff;">
        <div id="header"></div> <!-- Modify header content in header.html -->

        <!-- Breadcrumb -->
        <div class="container my-4">
            <nav>
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/index.html">Home</a></li>
                <li class="breadcrumb-item"><a href="/blog.html">Blog</a></li>
                <li class="breadcrumb-item active">Movie Tier List</li>
            </ol>
            </nav>
        </div>

        <!-- Blog Post Section -->
        <div class="container">
            <div class="row">
                <!-- Blog Content -->
                <div class="col-lg-8">
                    <article>
                        <h1 class="mb-3">Movie Tier List [Under Construction]</h1>
                        <p class="text-muted">Published on March 11, 2025 | By JW</p>

                        <p>
                            Here's a tier list of miscellaneous movies I've watched over the past several years. 
                            All ratings are absolute (not relative) scores out of 10. I am less likely to watch a movie 
                            that I anticipate I will not like, so the curve will not be normal in its distribution. 
                            In my ratings I usually emphasize plotline, cinematography/aesthetics, and meaning/impact, but 
                            frankly these are not as rigorous and consistent as I would prefer. To do that would require 
                            too much effort.
                        </p>
                        <p>
                            What trends do you notice? I tend to like movies that are cerebral and emotionally engaging. 
                            I like well-developed characters and plotlines, and I appreciate good cinematography. 
                            I avoid movies that were made more than a couple decades ago unless the visual qualities are 
                            not distractingly outdated. I prefer movies with unpredictable plot twists and endings. 
                            My favorite genre is thriller, and I will watch anything made by Christopher Nolan.
                        </p>
                        
                        <!-- Modified tier list maker below -->
                        <div class="tiers container" data-placeholder="Click on the title to add a new tier."></div>
                
                        <div class="upload-container container my-3">
                            <input type="file" id="image-upload" accept="image/*" multiple>
                        </div>
                    
                        <div class="cards container mb-4">
                          <!-- <img src="https://placehold.co/120x150/red/fff"/>
                          <img src="https://placehold.co/220x190/purple/fff"/>
                          <img src="https://placehold.co/300x120/teal/fff"/>
                          <img src="https://placehold.co/145/pink/fff"/>
                          <img src="https://placehold.co/90/hotpink/fff"/>
                          <img src="https://placehold.co/145/brown/fff"/>
                          <img src="https://placehold.co/110x165/darkorchid/fff"/>
                          <img src="https://placehold.co/220/bisque/fff"/>
                          <img src="https://placehold.co/135x150/lightseagreen/fff"/> -->
                        </div>
                    
                        <dialog class="settings-modal">
                          <section>
                            <div class="colors"></div>
                    
                            <textarea class="tier-label" placeholder="Tier label"></textarea>
                    
                            <button id="delete">Delete Row</button>
                            <button id="clear">Clear Row</button>
                            <button id="prepend">Add a Row Above</button>
                            <button id="append">Add a Row Below</button>
                          </section>
                        </dialog>
                
                        <div id="tooltip" style="position: absolute; display: none; background: #333; color: #fff; padding: 5px; border-radius: 3px; font-size: 0.875rem; pointer-events: none;"></div>
                
                
                    </article>

                    <!-- Author Info -->
                    <div id="authorBoxJW"></div> <!-- Modify centralized author box (for JW) in author-box-jw.html -->
                </div>

                <!-- Sidebar -->
                <aside class="col-lg-4">
                    <div class="sidebar">
                        <h5>Related</h5>
                        <ul class="list-unstyled">
                            <li><a href="#">Related Blog Title 1</a></li>
                            <li><a href="#">Related Blog Title 2</a></li>
                            <li><a href="#">Related Blog Title 3</a></li>
                        </ul>

                        <h5>Tags</h5>
                        <!-- Remove inapplicable tags -->
                        <div>
                            <a href="tags.html?tag=Entertainment" class="btn btn-sm me-1 mb-1 btn-tags">Entertainment</a>
                            <a href="tags.html?tag=Technology" class="btn btn-sm me-1 mb-1 btn-tags">Technology</a>
                            <a href="tags.html?tag=Miscellaneous" class="btn btn-sm me-1 mb-1 btn-tags">Miscellaneous</a>
                        </div>

                        <div id="blogSidebar"></div> <!-- Modify centralized sidebar in blog-sidebar.html -->
                    </div>
                </aside>
            </div>
        </div>


        <div id="footer"></div> <!-- Modify footer content in footer.html -->

        <!-- Bootstrap JS (includes Popper.js and Bootstrap JS) -->
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>

        <!-- My personal JS -->
        <script src="/scripts/app.js" defer></script>
        <script src="/scripts/blog.js" defer></script>
        <script src="/scripts/blog-sidebar.js" defer></script>
        <!-- <script type="module" src="/scripts/tier-list.js" defer></script> -->
        <!-- Add additional JS here as needed -->

        <!-- Manually edit tier-list.js below -->
        <script>
            // Preset tier data
            const tierData = {
            "S (9+)": [
                { name: "The Prestige", img: "/assets/images/blog/movies/the-prestige.jpg", note: "10" },
                { name: "Interstellar", img: "/assets/images/blog/movies/interstellar.jpg", note: "9.5" },
                { name: "Inception", img: "/assets/images/blog/movies/inception.jpg", note: "9.5" },
                { name: "Memento", img: "/assets/images/blog/movies/memento.jpg", note: "9" },

            ],
            "A (8+)": [

            ],
            "B (7+)": [],
            "C (5+)": [],
            "D (3+)": [],
            "F (<3)": []
            };


            const colors = [
            "#FF7F7F",
            "#FFBF7F",
            "#FFDF7F",
            "#FFFF7F",
            "#BFFF7F",
            "#7FFF7F",
            "#7FFFFF",
            "#7FBFFF",
            "#7F7FFF",
            "#FF7FFF",
            "#BF7FBF",
            "#CFCFCF",
            ];


            const tooltip = document.getElementById("tooltip");



            const settingsModal = document.querySelector(".settings-modal");
            const colorsContainer = settingsModal.querySelector(".colors");
            const tiersContainer = document.querySelector(".tiers");
            const cardsContainer = document.querySelector(".cards");

            let activeTier;

            const resetTierImages = (tier) => {
            const images = tier.querySelectorAll(".items img");
            images.forEach((img) => {
                cardsContainer.appendChild(img);
            });
            };

            const handleDeleteTier = () => {
            if (activeTier) {
                resetTierImages(activeTier);
                activeTier.remove();
                settingsModal.close();
            }
            };

            const handleClearTier = () => {
            if (activeTier) {
                resetTierImages(activeTier);
                settingsModal.close();
            }
            };

            const handlePrependTier = () => {
            if (activeTier) {
                tiersContainer.insertBefore(createTier(), activeTier);
                settingsModal.close();
            }
            };

            const handleAppendTier = () => {
            if (activeTier) {
                tiersContainer.insertBefore(createTier(), activeTier.nextSibling);
                settingsModal.close();
            }
            };

            const handleSettingsClick = (tier) => {
            activeTier = tier;

            // populate the textarea
            const label = tier.querySelector(".label");
            settingsModal.querySelector(".tier-label").value = label.innerText;

            // select the color
            const color = getComputedStyle(label).getPropertyValue("--color");
            settingsModal.querySelector(`input[value="${color}"]`).checked = true;

            settingsModal.showModal();
            };

            const handleMoveTier = (tier, direction) => {
            const sibling =
                direction === "up" ? tier.previousElementSibling : tier.nextElementSibling;

            if (sibling) {
                const position = direction === "up" ? "beforebegin" : "afterend";
                sibling.insertAdjacentElement(position, tier);
            }
            };

            const handleDragover = (event) => {
            event.preventDefault(); // allow drop

            const draggedImage = document.querySelector(".dragging");
            const target = event.target;

            if (target.classList.contains("items")) {
                target.appendChild(draggedImage);
            } else if (target.tagName === "IMG" && target !== draggedImage) {
                const { left, width } = target.getBoundingClientRect();
                const midPoint = left + width / 2;

                if (event.clientX < midPoint) {
                target.before(draggedImage);
                } else {
                target.after(draggedImage);
                }
            }
            };

            const handleDrop = (event) => {
            event.preventDefault(); // prevent default browser handling
            };

            const createTier = (label = "Change me", items = []) => {
            const tierColor = colors[tiersContainer.children.length % colors.length];

            const tier = document.createElement("div");
            tier.className = "tier";
            tier.innerHTML = `
            <div class="label" contenteditable="plaintext-only" style="--color: ${tierColor}">
                <span>${label}</span>
            </div>
            <div class="items"></div>
            <div class="controls">
                <button class="settings"><i class="bi bi-gear-fill"></i></button>
                <button class="moveup"><i class="bi bi-chevron-up"></i></button>
                <button class="movedown"><i class="bi bi-chevron-down"></i></button>
            </div>
            `;

            // Attach event listeners for tier controls
            tier.querySelector(".settings").addEventListener("click", () => handleSettingsClick(tier));
            tier.querySelector(".moveup").addEventListener("click", () => handleMoveTier(tier, "up"));
            tier.querySelector(".movedown").addEventListener("click", () => handleMoveTier(tier, "down"));
            tier.querySelector(".items").addEventListener("dragover", handleDragover);
            tier.querySelector(".items").addEventListener("drop", handleDrop);

            // If there are preset items, add them to the tier
            if (items.length > 0) {
                const itemsContainer = tier.querySelector(".items");
                items.forEach(item => {
                const img = document.createElement("img");
                img.src = item.img;
                img.alt = item.name;
                img.draggable = true;
                // Drag event listeners (same as in initDraggables)
                img.addEventListener("dragstart", (e) => {
                    e.dataTransfer.setData("text/plain", "");
                    img.classList.add("dragging");
                });
                img.addEventListener("dragend", () => img.classList.remove("dragging"));
                // Tooltip event listeners
                img.addEventListener("mouseenter", (e) => {
                    tooltip.innerText = item.note;
                    tooltip.style.display = "block";
                    tooltip.style.left = `${e.pageX + 10}px`;
                    tooltip.style.top = `${e.pageY + 10}px`;
                });
                img.addEventListener("mouseleave", () => {
                    tooltip.style.display = "none";
                });
                itemsContainer.appendChild(img);
                });
            }

            return tier;
            };

            const initColorOptions = () => {
            colors.forEach((color) => {
                const label = document.createElement("label");
                label.style.setProperty("--color", color);
                label.innerHTML = `<input type="radio" name="color" value="${color}" />`;
                colorsContainer.appendChild(label);
            });
            };

            // Allow users to upload images
            const imageUpload = document.getElementById("image-upload");
            imageUpload.addEventListener("change", (event) => {
            const files = event.target.files;
            for (const file of files) {
                const img = document.createElement("img");
                img.src = URL.createObjectURL(file);
                img.alt = file.name;
                img.draggable = true;
                
                // Add similar event listeners as in initDraggables()
                img.addEventListener("dragstart", (e) => {
                e.dataTransfer.setData("text/plain", "");
                img.classList.add("dragging");
                });
                img.addEventListener("dragend", () => img.classList.remove("dragging"));
                img.addEventListener("dblclick", () => {
                if (img.parentElement !== cardsContainer) {
                    cardsContainer.appendChild(img);
                    cardsContainer.scrollLeft = cardsContainer.scrollWidth;
                }
                });
                
                // Append the new image to the cards container
                cardsContainer.appendChild(img);
            }
            });

            const initDefaultTierList = () => {
            // Instead of using an array of labels, iterate over your preset tierData keys
            Object.keys(tierData).forEach(label => {
                tiersContainer.appendChild(createTier(label, tierData[label]));
            });
            };


            const initDraggables = () => {
            const images = cardsContainer.querySelectorAll("img");
            images.forEach((img) => {
                img.draggable = true;

                img.addEventListener("dragstart", (e) => {
                e.dataTransfer.setData("text/plain", "");
                img.classList.add("dragging");
                });

                img.addEventListener("dragend", () => img.classList.remove("dragging"));

                img.addEventListener("dblclick", () => {
                if (img.parentElement !== cardsContainer) {
                    cardsContainer.appendChild(img);
                    cardsContainer.scrollLeft = cardsContainer.scrollWidth;
                }
                });
            });
            };

            initDraggables();
            initDefaultTierList();
            initColorOptions();

            //* event listeners

            // Event listener that creates a new tier when the h1 is clicked
            // document.querySelector("h1").addEventListener("click", () => {
            //   tiersContainer.appendChild(createTier());
            // });

            settingsModal.addEventListener("click", (event) => {
            // if the clicked element is the settings modal then close it
            if (event.target === settingsModal) {
                settingsModal.close();
            } else {
                const action = event.target.id;
                const actionMap = {
                delete: handleDeleteTier,
                clear: handleClearTier,
                prepend: handlePrependTier,
                append: handleAppendTier,
                };

                if (action && actionMap[action]) {
                actionMap[action]();
                }
            }
            });

            settingsModal.addEventListener("close", () => (activeTier = null));

            settingsModal
            .querySelector(".tier-label")
            .addEventListener("input", (event) => {
                if (activeTier) {
                activeTier.querySelector(".label span").textContent = event.target.value;
                }
            });

            colorsContainer.addEventListener("change", (event) => {
            if (activeTier) {
                activeTier
                .querySelector(".label")
                .style.setProperty("--color", event.target.value);
            }
            });

            cardsContainer.addEventListener("dragover", (event) => {
            event.preventDefault();

            const draggedImage = document.querySelector(".dragging");
            if (draggedImage) {
                cardsContainer.appendChild(draggedImage);
            }
            });

            cardsContainer.addEventListener("drop", (event) => {
            event.preventDefault();
            cardsContainer.scrollLeft = cardsContainer.scrollWidth;
            });
        </script>
    </body>
</html>
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <title>
            Price Pilot
        </title>

        <!-- Favicon links (generated by favicon.io) -->
        <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
        <link rel="manifest" href="/assets/favicon/site.webmanifest">

        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

        <!-- My personal CSS -->
        <link rel="stylesheet" href="/styles/fonts.css">
        <link rel="stylesheet" href="/styles/style.css">
        <!-- Add additional stylesheets here to override original styles as needed -->

        <style>
            .formula-section {
              margin-bottom: 60px;
              border-bottom: 1px solid #ddd;
              padding-bottom: 20px;
            }
            .chart-container {
              position: relative;
              height: 300px;
              width: 100%;
              margin-top: 20px;
            }
            table {
              margin-top: 20px;
            }
          </style>

          <!-- Chart.js Library -->
          <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    </head>
    <body>
        <div id="header"></div> <!-- Modify header content in header.html -->

<main>

  <h1>Price Pilot</h1>
  <p>Use this interactive tool to calculate scaling prices per customer (or unit, etc.). Enter the parameters below, and the pricing models, charts, and tables will update automatically.</p>
  
  <!-- Input Form -->
  <form id="parameters-form" class="mb-4">
    <div class="mb-3 col-md-6">
      <label for="hourlyRate" class="form-label">Hourly Rate ($)</label>
      <input type="number" id="hourlyRate" class="form-control" value="150" step="0.01" required>
    </div>
    <div class="mb-3 col-md-6">
      <label for="sessionLength" class="form-label">Session Length (minutes)</label>
      <input type="number" id="sessionLength" class="form-control" value="60" required>
    </div>
    <div class="mb-3 col-md-6">
      <label for="decay" class="form-label">Decay Factor (0–1) [for Geometric Formula]</label>
      <input type="number" id="decay" class="form-control" value="0.8" step="0.01" required>
    </div>
    <div class="mb-3 col-md-6">
      <label for="rate" class="form-label">Additional Rate ($) [for extra customers; this can be the same as the Hourly Rate or different]</label>
      <input type="number" id="rate" class="form-control" value="50" step="0.01" required>
    </div>
    <div class="mb-3 col-md-6">
      <label for="alpha" class="form-label">Alpha (for Power Law, between 0 and 1)</label>
      <input type="number" id="alpha" class="form-control" value="0.5" step="0.01" required>
    </div>
    <button type="submit" class="btn btn-primary">Calculate</button>
  </form>
  
  <!-- Results Section -->
  <div id="results">
    <!-- Formula 1: Geometric Decay Formula -->
    <div class="formula-section" id="formulaGDF">
      <h2>Geometric Decay Formula</h2>
      <p>
        <strong>Formula:</strong><br>
        <code>Price(1) = Base Price<br>
        Price(n) = Base Price + Additional Rate × decay × (1 – decay^(n–1)) / (1 – decay) for n &gt; 1</code><br>
        <em>Use this when additional customer cost decreases exponentially.</em>
      </p>

        <!-- Additional information for geometric decay formula -->
        <div class="accordion mb-3" id="gdfAccordion">
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseGDF">
                        Geometric Decay Formula (Recursive Form)
                    </button>
                </h2>
                <div id="collapseGDF" class="accordion-collapse collapse">
                    <div class="accordion-body">
                        <div class="formula-info">
                            <p>
                            This pricing model is designed so that the incremental cost for each additional customer decreases by a constant factor (the <em>decay</em> value). In its recursive form, the formula is defined as follows:
                            </p>
                            <ul>
                            <li>
                                <strong>Base Case:</strong> For a single customer (n = 1), the price is:
                                <br>
                                <code>Price(1) = Base Price</code>
                            </li>
                            <li>
                                <strong>Recursive Case:</strong> For n ≥ 2, the price is determined by adding a discounted extra cost to the previous total:
                                <br>
                                <code>Price(n) = Price(n-1) + Additional Rate × decay^(n-1)</code>
                            </li>
                            </ul>
                            <p>
                            In this formulation, the parameter <code>decay</code> (a number between 0 and 1) acts as a discount factor. For example, when n = 2:
                            </p>
                            <p>
                            <code>Price(2) = Base Price + Additional Rate × decay</code>
                            </p>
                            <p>
                            Thus, the additional cost for the second customer is only a fraction (<em>decay</em>) of the full additional rate.
                            </p>
                            <p>
                            This recursive relationship can be expanded into the following closed-form expression:
                            </p>
                            <p>
                            <code>
                                Price(n) = Base Price + Additional Rate × [decay × (1 – decay^(n–1))] / (1 – decay)
                            </code>
                            </p>
                            <p>
                            This version makes it clear that as the number of customers increases, the extra cost added by each new customer is discounted exponentially. Use this formula when you want the cost for each additional customer to be lower than the full additional rate starting from the second customer.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

      
      <p id="formulaGDFResults"></p>
      <div class="chart-container">
        <canvas id="gdfTotalChart"></canvas>
      </div>
      <div class="chart-container">
        <canvas id="gdfAvgChart"></canvas>
      </div>
      <div class="table-responsive col-md-4">
        <table class="table" id="gdfTable"></table>
      </div>
    </div>
    
    <!-- Formula 2: Linear Pricing Formula -->
    <div class="formula-section" id="formulaLPF">
      <h2>Linear Formula</h2>
      <p>
        <strong>Formula:</strong><br>
        <code>Price(n) = Base Price + Additional Rate × (n – 1)</code><br>
        <em>Use this when each extra customer adds a fixed extra cost.</em>
      </p>
      <p id="formulaLPFResults"></p>
      <div class="chart-container">
        <canvas id="lpfTotalChart"></canvas>
      </div>
      <div class="chart-container">
        <canvas id="lpfAvgChart"></canvas>
      </div>
      <div class="table-responsive col-md-4">
        <table class="table" id="lpfTable"></table>
      </div>
    </div>
    
    <!-- Formula 3: Logarithmic Pricing Formula -->
    <div class="formula-section" id="formulaLF">
      <h2>Logarithmic Formula</h2>
      <p>
        <strong>Formula:</strong><br>
        <code>Price(n) = Base Price + Additional Rate × ln(n)</code><br>
        <em>Use this when the incremental cost grows slowly as customer count increases.</em>
      </p>
      <p id="formulaLFResults"></p>
      <div class="chart-container">
        <canvas id="lfTotalChart"></canvas>
      </div>
      <div class="chart-container">
        <canvas id="lfAvgChart"></canvas>
      </div>
      <div class="table-responsive col-md-4">
        <table class="table" id="lfTable"></table>
      </div>
    </div>
    
    <!-- Formula 4: Power Law Pricing Formula -->
    <div class="formula-section" id="formulaPLF">
      <h2>Power Law Formula</h2>
      <p>
        <strong>Formula:</strong><br>
        <code>Price(n) = Base Price + Additional Rate × (n^α – 1)</code><br>
        <em>Use this when additional cost increases at a diminishing rate (0 &lt; α &lt; 1).</em>
      </p>
      <p id="formulaPLFResults"></p>
      <div class="chart-container">
        <canvas id="plfTotalChart"></canvas>
      </div>
      <div class="chart-container">
        <canvas id="plfAvgChart"></canvas>
      </div>
      <div class="table-responsive col-md-4">
        <table class="table" id="plfTable"></table>
      </div>
    </div>
    
    <!-- Formula 5: Quadratic Pricing Formula -->
    <div class="formula-section" id="formulaQPF">
      <h2>Quadratic Formula</h2>
      <p>
        <strong>Formula:</strong><br>
        <code>Price(n) = Base Price + Additional Rate × (n – 1)²</code><br>
        <em>Use this when the cost increases more sharply with additional customers.</em>
      </p>
      <p id="formulaQPFResults"></p>
      <div class="chart-container">
        <canvas id="qpfTotalChart"></canvas>
      </div>
      <div class="chart-container">
        <canvas id="qpfAvgChart"></canvas>
      </div>
      <div class="table-responsive col-md-4">
        <table class="table" id="qpfTable"></table>
      </div>
    </div>
    
    <!-- Formula 6: Square Root Pricing Formula -->
    <div class="formula-section" id="formulaSRPF">
      <h2>Square Root Formula</h2>
      <p>
        <strong>Formula:</strong><br>
        <code>Price(n) = Base Price + Additional Rate × (√n – 1)</code><br>
        <em>Use this when the additional cost per customer grows very slowly.</em>
      </p>
      <p id="formulaSRPFResults"></p>
      <div class="chart-container">
        <canvas id="srpfTotalChart"></canvas>
      </div>
      <div class="chart-container">
        <canvas id="srpfAvgChart"></canvas>
      </div>
      <div class="table-responsive col-md-4">
        <table class="table" id="srpfTable"></table>
      </div>
    </div>
  </div>

</main>

    <!-- JavaScript Code -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
          const form = document.getElementById('parameters-form');
          // Global chart variables (for destruction on re-calc)
          let gdfTotalChart, gdfAvgChart, lpfTotalChart, lpfAvgChart, lfTotalChart, lfAvgChart, plfTotalChart, plfAvgChart, qpfTotalChart, qpfAvgChart, srpfTotalChart, srpfAvgChart;
          
          form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Retrieve input values
            const hourlyRate = parseFloat(document.getElementById('hourlyRate').value);
            const sessionLength = parseFloat(document.getElementById('sessionLength').value);
            const decay = parseFloat(document.getElementById('decay').value);
            const additionalRate = parseFloat(document.getElementById('rate').value);
            const alpha = parseFloat(document.getElementById('alpha').value);
            
            // Base price for one customer
            const basePrice = (hourlyRate / 60) * sessionLength;
            const maxCustomers = 20;
            
            // Helper function: Calculate price arrays given a pricing function f(n)
            function calculatePrices(formulaFunc) {
              const total = [];
              const avg = [];
              for (let n = 1; n <= maxCustomers; n++) {
                let price = formulaFunc(n);
                total.push(price);
                avg.push(price / n);
              }
              return { total, avg };
            }
            
            // --- Formulas ---
            
            // Geometric Decay Formula
            // const gdf = calculatePrices(n => {
            //   if(n === 1) return basePrice;
            //   return basePrice + additionalRate * ((1 - Math.pow(decay, n - 1)) / (1 - decay));
            // });
    
            // Geometric Decay Formula with initial discount applied from n = 2
            const gdf = calculatePrices(n => {
              if(n === 1) return basePrice;
              // Multiply by decay so that for n=2, the extra cost is additionalRate * decay, not additionalRate.
              return basePrice + additionalRate * decay * ((1 - Math.pow(decay, n - 1)) / (1 - decay));
            });
    
            // Linear Pricing Formula
            const lpf = calculatePrices(n => {
              if(n === 1) return basePrice;
              return basePrice + additionalRate * (n - 1);
            });
    
            // Logarithmic Pricing Formula
            const lf = calculatePrices(n => {
              return basePrice + additionalRate * Math.log(n);
            });
    
            // Power Law Pricing Formula
            const plf = calculatePrices(n => {
              return basePrice + additionalRate * (Math.pow(n, alpha) - 1);
            });
    
            // Quadratic Pricing Formula
            const qpf = calculatePrices(n => {
              if(n === 1) return basePrice;
              return basePrice + additionalRate * Math.pow(n - 1, 2);
            });
    
            // Square Root Pricing Formula
            const srpf = calculatePrices(n => {
              return basePrice + additionalRate * (Math.sqrt(n) - 1);
            });
            
            // Update textual results for each formula
            document.getElementById('formulaGDFResults').innerText =
              `Total price from $${gdf.total[0].toFixed(2)} (n=1) to $${gdf.total[maxCustomers-1].toFixed(2)} (n=${maxCustomers}).\nAverage price from $${gdf.avg[0].toFixed(2)} to $${gdf.avg[maxCustomers-1].toFixed(2)}.`;
              
            document.getElementById('formulaLPFResults').innerText =
              `Total price from $${lpf.total[0].toFixed(2)} to $${lpf.total[maxCustomers-1].toFixed(2)}.\nAverage price from $${lpf.avg[0].toFixed(2)} to $${lpf.avg[maxCustomers-1].toFixed(2)}.`;
              
            document.getElementById('formulaLFResults').innerText =
              `Total price from $${lf.total[0].toFixed(2)} to $${lf.total[maxCustomers-1].toFixed(2)}.\nAverage price from $${lf.avg[0].toFixed(2)} to $${lf.avg[maxCustomers-1].toFixed(2)}.`;
              
            document.getElementById('formulaPLFResults').innerText =
              `Total price from $${plf.total[0].toFixed(2)} to $${plf.total[maxCustomers-1].toFixed(2)}.\nAverage price from $${plf.avg[0].toFixed(2)} to $${plf.avg[maxCustomers-1].toFixed(2)}.`;
              
            document.getElementById('formulaQPFResults').innerText =
              `Total price from $${qpf.total[0].toFixed(2)} to $${qpf.total[maxCustomers-1].toFixed(2)}.\nAverage price from $${qpf.avg[0].toFixed(2)} to $${qpf.avg[maxCustomers-1].toFixed(2)}.`;
              
            document.getElementById('formulaSRPFResults').innerText =
              `Total price from $${srpf.total[0].toFixed(2)} to $${srpf.total[maxCustomers-1].toFixed(2)}.\nAverage price from $${srpf.avg[0].toFixed(2)} to $${srpf.avg[maxCustomers-1].toFixed(2)}.`;
            
            // Helper function to update Chart.js charts
            function updateChart(chartInstance, ctx, labels, data, datasetLabel, borderColor) {
              if (chartInstance) {
                chartInstance.destroy();
              }
              return new Chart(ctx, {
                type: 'line',
                data: {
                  labels: labels,
                  datasets: [{
                    label: datasetLabel,
                    data: data,
                    borderColor: borderColor,
                    fill: false,
                    tension: 0.1
                  }]
                },
                options: {
                  scales: {
                    x: { title: { display: true, text: 'Number of Customers' } },
                    y: { title: { display: true, text: datasetLabel } }
                  }
                }
              });
            }
            
            // Helper function to update a table with results
            function updateTable(tableElementId, labels, totalData, avgData) {
              let tableHTML = `<thead><tr><th>n</th><th>Total Price ($)</th><th>Average Price ($)</th></tr></thead><tbody>`;
              for (let i = 0; i < labels.length; i++) {
                tableHTML += `<tr>
                                <td>${labels[i]}</td>
                                <td>${totalData[i].toFixed(2)}</td>
                                <td>${avgData[i].toFixed(2)}</td>
                              </tr>`;
              }
              tableHTML += `</tbody>`;
              document.getElementById(tableElementId).innerHTML = tableHTML;
            }
            
            // Create x-axis labels (n = 1,2,...,maxCustomers)
            const labels = Array.from({ length: maxCustomers }, (_, i) => i + 1);
            
            // Update charts and tables for each formula:
            // Geometric Decay Formula
            gdfTotalChart = updateChart(gdfTotalChart, document.getElementById('gdfTotalChart').getContext('2d'), labels, gdf.total, 'Total Price ($)', 'blue');
            gdfAvgChart = updateChart(gdfAvgChart, document.getElementById('gdfAvgChart').getContext('2d'), labels, gdf.avg, 'Average Price ($)', 'green');
            updateTable('gdfTable', labels, gdf.total, gdf.avg);
            
            // Linear Pricing Formula
            lpfTotalChart = updateChart(lpfTotalChart, document.getElementById('lpfTotalChart').getContext('2d'), labels, lpf.total, 'Total Price ($)', 'blue');
            lpfAvgChart = updateChart(lpfAvgChart, document.getElementById('lpfAvgChart').getContext('2d'), labels, lpf.avg, 'Average Price ($)', 'green');
            updateTable('lpfTable', labels, lpf.total, lpf.avg);
            
            // Logarithmic Pricing Formula
            lfTotalChart = updateChart(lfTotalChart, document.getElementById('lfTotalChart').getContext('2d'), labels, lf.total, 'Total Price ($)', 'blue');
            lfAvgChart = updateChart(lfAvgChart, document.getElementById('lfAvgChart').getContext('2d'), labels, lf.avg, 'Average Price ($)', 'green');
            updateTable('lfTable', labels, lf.total, lf.avg);
            
            // Power Law Pricing Formula
            plfTotalChart = updateChart(plfTotalChart, document.getElementById('plfTotalChart').getContext('2d'), labels, plf.total, 'Total Price ($)', 'blue');
            plfAvgChart = updateChart(plfAvgChart, document.getElementById('plfAvgChart').getContext('2d'), labels, plf.avg, 'Average Price ($)', 'green');
            updateTable('plfTable', labels, plf.total, plf.avg);
            
            // Quadratic Pricing Formula
            qpfTotalChart = updateChart(qpfTotalChart, document.getElementById('qpfTotalChart').getContext('2d'), labels, qpf.total, 'Total Price ($)', 'blue');
            qpfAvgChart = updateChart(qpfAvgChart, document.getElementById('qpfAvgChart').getContext('2d'), labels, qpf.avg, 'Average Price ($)', 'green');
            updateTable('qpfTable', labels, qpf.total, qpf.avg);
            
            // Square Root Pricing Formula
            srpfTotalChart = updateChart(srpfTotalChart, document.getElementById('srpfTotalChart').getContext('2d'), labels, srpf.total, 'Total Price ($)', 'blue');
            srpfAvgChart = updateChart(srpfAvgChart, document.getElementById('srpfAvgChart').getContext('2d'), labels, srpf.avg, 'Average Price ($)', 'green');
            updateTable('srpfTable', labels, srpf.total, srpf.avg);
          });
        });
      </script>
    

        <div id="footer"></div> <!-- Modify footer content in footer.html -->

        <!-- Bootstrap JS (includes Popper.js and Bootstrap JS) -->
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>

        <!-- My personal JS -->
        <script src="/scripts/app.js" defer></script>
        <!-- Add additional JS here as needed -->
    </body>
</html>